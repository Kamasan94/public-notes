#cybersecurity #soc 

We need to create a Yara rule to detect this specific web shell (file 2 of previous task)

Let's check how many lines this particular file has

```bash
strings 1ndex.php | wc -l
```

We can use yarGen, generator for Yara rules

```
cd ~/tools/yarGen/
python3 yarGen.py --update
```


To generate the rule for file2

```bash
python3 yarGen.py -m /home/cmnatic/suspicious-files/file2 --excludegood -o /home/cmnatic/suspicious-files/file2.yar
```

- -m is the path to the files you want to generate rules for
- -excludegood force to exclude all goodware strings (these are strings found in legitimate software and can increase false positives)
- -o location & name you want to output the Yara rule


### Questions
**From within the root of the suspicious files directory, what command would you run to test Yara and your Yara rule against file 2?**
yara file2.yar file2/1ndex.php

**Did Yara rule flag file 2? (Yay/Nay)**
Yay

**Copy the Yara rule you created into the Loki signatures directory.**
`cp file2.yar ../tools/Loki/signature-base/yara/`

**Test the Yara rule with Loki, does it flag file 2? (Yay/Nay)**
Used the command of previous task
yay

**What is the name of the variable for the string that it matched on?**
MATCHES: Str1: var Zepto

**Inspect the Yara rule, how many strings were generated?**
20

**One of the conditions to match on the Yara rule specifies file size. The file has to be less than what amount?**]
700kb