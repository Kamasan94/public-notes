#cybersecurity #soc #network 

### Scripts 203 | Load Frameworks

#### **File Framework | Hashes**
Not all framework functionalities are intended to be used in CLI mode. The majority of them are used in scripting.
Now, let's use a prebuilt function of the file framework and have MD5, SHA1 and SHA256 hashes of the detected files.

`zeek -C -r case1.pcap hash-demo.zeek`


#### File Framework | Extract Files
```bash
zeek -C -r case1.pcap /opt/zeek/share/zeek/policy/frameworks/files/extract-all-files.zeek
```
We successfully extracted files from the pcap. A new folder called "extract_files" is automatically created, and all detected files are located in it. First, we will list the contents of the folder, and then we will use the `file` command to determine the file type of the extracted files.


#### Notice Framework | Intelligence
The intelligence framework can work with data feeds to process and correlate events and identify anomalies.
Intelligence source location: `/opt/zeek/intel/zeek_intel.txt`
There are two critical points you should never forget. First, the source file has to be tab-delimited. Second, you can manually update the source and adding extra lines doesn't require any re-deployment. However, if you delete a line from the file, you will need to re-deploy the Zeek instance.


### Questions
**Investigate the case1.pcap file with intelligence-demo.zeek script. Investigate the intel.log file. Look at the second finding, where was the intel info found?**
```
zeek -C -r case1.pcap intelligence-demo.zeek
```
![[Pasted image 20240607105703.png]]

**Investigate the http.log file. What is the name of the downloaded .exe file?****
knr.exe

**Investigate the case1.pcap file with hash-demo.zeek script. Investigate the files.log file. What is the MD5 hash of the downloaded .exe file?**
cc28e40b46237ab6d5282199ef78c464
