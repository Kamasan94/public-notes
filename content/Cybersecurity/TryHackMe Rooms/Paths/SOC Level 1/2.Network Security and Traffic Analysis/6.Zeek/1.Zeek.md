#cybersecurity #soc #network 

#### Network Monitoring
Focused on:
- uptime
- device health
- connection quality
- network traffic balance

#### Network Security Monitoring
Focused on network anomalies


### Zeek
[[Open Source]] and commercial passive Network Monitoring tool

### Zeek vs [[1.Snort|Snort]]

|   |   |   |
|---|---|---|
|**Tool**|**Zeek**|**Snort**|
|**Capabilities**|NSM and IDS framework. It is heavily focused on network analysis. It is more focused on specific threats to trigger alerts. The detection mechanism is focused on events.|An IDS/IPS system. It is heavily focused on signatures to detect vulnerabilities. The detection mechanism is focused on signature patterns and packets.|
|**Cons**|Hard to use.<br><br>The analysis is done out of the Zeek, manually or by automation.|Hard to detect complex threats.|
|**Pros**|It provides in-depth traffic visibility.<br><br>Useful for threat hunting.<br><br>Ability to detect complex threats.<br><br>It has a scripting language and supports event correlation. <br><br>Easy to read logs.|Easy to write rules.<br><br>Cisco supported rules.<br><br>Community support.|
|**Common Use Case**|Network monitoring.  <br>In-depth traffic investigation.  <br>Intrusion detecting in chained events.|Intrusion detection and prevention.  <br>Stop known attacks/threats.|

### Zeek Architecture
Two primary layers:
- Event Engine, where packets are processed
- Policy Script Interpreter, where semantic analysis is conducted


### Zeek Frameworks
|   |   |   |   |   |
|---|---|---|---|---|
|Logging|Notice|Input|Configuration|Intelligence|
|Cluster|Broker Communication|Supervisor|GeoLocation|File Analysis|
|Signature|Summary|NetControl|Packet Analysis|TLS Decryption|

### **Working with Zeek**
There are two operation options for Zeek. The first one is running it as a service, and the second option is running the Zeek against a pcap

`zeekctl` to see the Zeek service
- `zeekctl status`
- `zeekctl start` 
- `zeekctl stop`

|   |   |
|---|---|
|**Parameter**|**Description**|
|**-r**|Reading option, read/process a pcap file.|
|**-C**|Ignoring checksum errors.|
|**-v**|Version information.|
|**zeekctl**|ZeekControl module.|


### Questions
**What is the installed Zeek instance version number?**
`zeek -v` 
4.2.1

**What is the version of the ZeekControl module?**
`zeekctl`
Welcome to ZeekControl 2.4.0

**Investigate the "sample.pcap" file. What is the number of generated alert files?**
`zeek -C -r sample.pcap`
![[Pasted image 20240606102449.png]]



