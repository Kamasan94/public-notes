#cybersecurity #soc #network 


|   |   |
|---|---|
|**Parameter**|**Description**|
|-l|Logger mode, target **log and alert** output directory. Default output folder is **/var/log/snort**<br><br>The default action is to dump as tcpdump format in **/var/log/snort**|
|**-K ASCII**|Log packets in ASCII format.|
|-r|Reading option, read the dumped logs in Snort.|
|**-n**|Specify the number of packets that will process/read. Snort will stop after reading the specified number of packets.|

### **Logfile Ownership**

**Whoever creates a file becomes the owner of the corresponding file**.

### Logging with parameter "-l"

First, start the Snort instance in packet logger mode; `sudo snort -dev -l .`

### Logging with parameter "-K ASCII"

Start the Snort instance in packet logger mode; `sudo snort -dev -K ASCII`
In a nutshell, ASCII mode provides multiple files in human-readable format, so it is possible to read the logs easily by using a text editor

### Reading generated logs with parameter "-r"

```bash
sudo snort -r snort.log.1638459842
```


### Questions

Investigate the traffic with the default configuration file with ASCII mode.
Execute the traffic generator script and choose "TASK-6 Exercise". Wait until the traffic ends, then stop the Snort instance. Now analyse the output summary and answer the question.

**Now, you should have the logs in the current directory. Navigate to folder "145.254.160.237". 
What is the source port used to connect port 53?**
Just cat the file UDP:3009-53 -> 3009


**Use snort.log.1640048004   
Read the snort.log file with Snort; what is the IP ID of the 10th packet?**
`snort -r snort.log.1640048004 -n 10`
Just read the file 49313

**Read the "snort.log.1640048004" file with Snort; what is the referer of the 4th packet?**
http://www.ethereal.com/development.html

**Read the "snort.log.1640048004" file with Snort; what is the Ack number of the 8th packet?**
0x38AFFFF3

**Read the "snort.log.1640048004" file with Snort; what is the number of the "TCP port 80" packets?**

```bash
snort -r snort.log.1640048004 'tcp and port 80'
```
