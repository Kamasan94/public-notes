#cybersecurity #soc #network 

Navigate to the task folder.  
Use the given pcap file.  
Write a **single** rule to detect "**all TCP port 21**"  traffic in the given pcap.  
What is the number of detected packets?

Same thing  of the previous task, just change the port number

**What is the FTP service name?**
Microsoft FTP Service

**Clear the previous log and alarm files.**  
**Deactivate/comment on the old rules.**
**Write a rule to detect failed FTP login attempts in the given pcap.**  
**What is the number of detected packets?**
The rule for detecting failed FTP login uses the response code 530
`alert TCP any any <> any 21 (msg:"ftp TRAFFIC!";content:"530";reference:1;sid:10000001;rev:1;)`
41


**Clear the previous log and alarm files.**  
**Deactivate/comment on the old rule.**  
**Write a rule to detect successful FTP logins in the given pcap.**  
**What is the number of detected packets?**
`alert TCP any any <> any 21 (msg:"ftp TRAFFIC!";content:"230";reference:1;sid:10000001;rev:1;)`
1


**Clear the previous log and alarm files.**  
**Deactivate/comment on the old rule.**  
**Write a rule to detect FTP login attempts with a valid username but no password entered yet.**  
**What is the number of detected packets?**
`alert TCP any any <> any 21 (msg:"ftp TRAFFIC!";content:"331";reference:1;sid:10000001;rev:1;)`
42



**Clear the previous log and alarm files.**  
**Deactivate/comment on the old rule.**  
**Write a rule to detect FTP login attempts with the "Administrator" username but no password entered yet.**  
**What is the number of detected packets?**
`alert TCP any any <> any 21 (msg:"ftp TRAFFIC!";content:"required for Administrator";reference:1;sid:10000001;rev:1;)`
7


