#cybersecurity #soc #network 

Using queries to filter packets
Two type of filters in Wireshark

|   |   |
|---|---|
|**Capture Filters**|This type of filter is used to save only a specific part of the traffic. It is set before capturing traffic and not changeable during the capture.|
|**Display Filters**|This type of filter is used to investigate packets by reducing the number of visible packets, and it is changeable during the capture.|


### Capture Filter Syntax

These use bytes offsets hex values and masks with boolean operators

- Scope: host, net, port and portrange.
- Direction: src, dst, src or dst, src and dst,
- Protocol: ether, wlan, ip, ip6, arp, rarp, tcp and udp.
- Sample filter to capture port 80 traffic: `tcp port 80`

You can read more on capture filter syntax from [here](https://www.wireshark.org/docs/man-pages/pcap-filter.html) and [here](https://gitlab.com/wireshark/wireshark/-/wikis/CaptureFilters#useful-filters). A quick reference is available under the **"Capture --> Capture Filters"** menu.


### Display Filter Syntax
Wireshark's most powerful feature
Supports 3000 protocols
- Sample filter to capture port 80 traffic: `tcp.port == 80`


### Comparison Operators
|   |   |   |   |
|---|---|---|---|
|**English**|**C-Like**|**Description**|**Example**|
|eq|==|Equal|`ip.src == 10.10.10.100`|
|ne|!=|Not equal|`ip.src != 10.10.10.100`|
|gt|>|Greater than|`ip.ttl > 250`|
|lt|<|Less Than|`ip.ttl < 10`|
|ge|>=|Greater than or equal to|`ip.ttl >= 0xFA`|
|le|<=|Less than or equal to|`ip.ttl <= 0xA`|

### Logical Expressions
|   |   |   |   |
|---|---|---|---|
|**English**|**C-Like**|**Description**|**Example**|
|and|&&|Logical AND|`(ip.src == 10.10.10.100) AND (ip.src == 10.10.10.111)`|
|or|\||Logical OR|`(ip.src == 10.10.10.100) OR (ip.src == 10.10.10.111)`|
|not|!|Logical NOT|`!(ip.src == 10.10.10.222)`<br><br>**Note:** Usage of `!=value` is deprecated; using it could provide inconsistent results. Using the `!(value)` style is suggested for more consistent results.|

### Packet Filter Toolbar

The filter toolbar is where you create and apply your display filters. It is a smart toolbar that helps you create valid display filters with ease. Before starting to filter packets, here are a few tips:  

- Packet filters are defined in lowercase.
- Packet filters have an autocomplete feature to break down protocol details, and each detail is represented by a "dot".
- Packet filters have a three-colour representation explained below.